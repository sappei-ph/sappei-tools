<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>痛みの評価スケール</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body { font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- 必要なアイコン ---
        const Smile = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" x2="9.01" y1="9" y2="9"/><line x1="15" x2="15.01" y1="9" y2="9"/></svg>
        );
        const Info = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
        );

        // --- 痛みの評価スケールコンポーネント ---
        function PainScale() {
            const [mode, setMode] = useState('nrs'); // 'nrs', 'fps'
            const [selectedScore, setSelectedScore] = useState(null);
            const [showDescription, setShowDescription] = useState(false);

            // FPSの顔アイコン描画関数 (Wong-Baker風)
            const getFaceIcon = (level, isSelected) => {
                const color = isSelected ? "text-blue-600" : "text-gray-400";
                const strokeWidth = isSelected ? "2.5" : "2";

                const faces = [
                    // 0: 笑顔
                    <g>
                        <path d="M7 15 C7 15, 9 18, 12 18 C15 18, 17 15, 17 15" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />
                        <path d="M7 15 L17 15" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />
                    </g>,
                    // 2: 少し笑顔
                    <path d="M7 16 C7 16, 9 18, 12 18 C15 18, 17 16, 17 16" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />,
                    // 4: 普通
                    <path d="M8 16 L16 16" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />,
                    // 6: 少し辛そう
                    <path d="M7 17 C7 17, 9 15, 12 15 C15 15, 17 17, 17 17" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />,
                    // 8: 辛そう
                    <g>
                        <path d="M7 17 C7 17, 9 15, 12 15 C15 15, 17 17, 17 17" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />
                    </g>,
                    // 10: 泣いている
                    <g>
                        <path d="M8 16 C8 16, 10 14, 12 14 C14 14, 16 16, 16 16" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />
                        <path d="M8 16 L16 16" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />
                        <path d="M7 12 L7 14" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />
                        <path d="M17 12 L17 14" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />
                    </g>
                ];
                
                // 目の定義
                const eyes = level === 10 ? 
                    <g>
                        <path d="M6 9 L9 11" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />
                        <path d="M9 9 L6 11" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />
                        <path d="M15 9 L18 11" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />
                        <path d="M18 9 L15 11" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" />
                    </g> :
                    <g><circle cx="8" cy="9" r="1.5" fill="currentColor" stroke="none"/><circle cx="16" cy="9" r="1.5" fill="currentColor" stroke="none"/></g>;

                return (
                    <svg viewBox="0 0 24 24" className={`w-12 h-12 transition-colors ${color}`} fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" strokeWidth={strokeWidth} />
                        {eyes}
                        {faces[level/2]}
                    </svg>
                );
            };

            const descriptions = {
                nrs: "0から10までの11段階で痛みの強さを評価します。「0」を痛みなし、「10」を想像できる最大の痛みとして、現在の痛みがどのくらいの数字になるかを選んでください。",
                fps: "6段階の顔の表情から、現在の痛みの強さに最も近いものを選んでください。言葉で表現するのが難しい場合や、高齢者・小児の評価に適しています。"
            };

            return (
                <div className="min-h-screen bg-gray-50 flex flex-col items-center font-sans text-gray-800 pb-12">
                    <header className="w-full bg-slate-800 text-white py-4 px-6 shadow-md flex justify-center sticky top-0 z-20">
                        <div className="max-w-4xl w-full flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <Smile className="w-6 h-6 text-yellow-400" />
                                <h1 className="text-xl font-bold tracking-wide">痛みの評価スケール</h1>
                            </div>
                            <div className="flex items-center text-xs text-slate-400 mt-1 ml-10">
                                <span>監修：薬剤師さっぺい🐨</span>
                            </div>
                        </div>
                    </header>

                    <main className="w-full max-w-4xl px-4 py-8 space-y-6">
                        
                        {/* タブ切り替え */}
                        <div className="bg-white p-2 rounded-xl shadow-sm border border-gray-200 flex">
                            <button 
                                onClick={() => { setMode('nrs'); setSelectedScore(null); setShowDescription(false); }}
                                className={`flex-1 py-3 rounded-lg font-bold text-lg transition-all ${mode === 'nrs' ? 'bg-blue-600 text-white shadow-md' : 'text-gray-500 hover:bg-gray-50'}`}
                            >
                                NRS
                            </button>
                            <button 
                                onClick={() => { setMode('fps'); setSelectedScore(null); setShowDescription(false); }}
                                className={`flex-1 py-3 rounded-lg font-bold text-lg transition-all ${mode === 'fps' ? 'bg-blue-600 text-white shadow-md' : 'text-gray-500 hover:bg-gray-50'}`}
                            >
                                FPS
                            </button>
                        </div>

                        {/* メインスケール表示エリア */}
                        <div className="bg-white p-8 rounded-xl shadow-sm border border-gray-200 min-h-[300px] flex flex-col items-center justify-center">
                            
                            {/* NRSモード (横長バー形式) */}
                            {mode === 'nrs' && (
                                <div className="w-full space-y-8">
                                    <h2 className="text-center font-bold text-slate-700 text-lg mb-2">Numerical Rating Scale (NRS)</h2>
                                    <div className="relative w-full border-2 border-black h-16 flex items-center bg-white">
                                        {[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map((num) => (
                                            <div key={num} className="flex-1 h-full flex items-center justify-center relative cursor-pointer" onClick={() => setSelectedScore(num)}>
                                                {/* タッチ領域 */}
                                                <div className="absolute inset-0 z-10"></div>
                                                <span className={`text-xl font-bold z-0 transition-all ${selectedScore === num ? 'text-blue-600 scale-150' : 'text-black'}`}>
                                                    {num}
                                                </span>
                                                {/* 選択マーカー */}
                                                {selectedScore === num && (
                                                    <div className="absolute w-10 h-10 rounded-full border-2 border-blue-600 -z-0"></div>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* FPSモード (横並び顔アイコン形式) */}
                            {mode === 'fps' && (
                                <div className="w-full space-y-8">
                                    <h2 className="text-center font-bold text-slate-700 text-lg mb-2">Faces Pain Scale (FPS)</h2>
                                    <div className="relative w-full border-2 border-black p-4 flex justify-between items-center bg-white overflow-x-auto">
                                        {[0, 2, 4, 6, 8, 10].map((level) => (
                                            <div key={level} className="flex flex-col items-center gap-1 cursor-pointer p-2 rounded-lg transition-all" 
                                                onClick={() => setSelectedScore(level)}
                                            >
                                                <div className={`transform transition-transform ${selectedScore === level ? 'scale-125' : ''}`}>
                                                    {getFaceIcon(level, selectedScore === level)}
                                                </div>
                                                {selectedScore === level && (
                                                     <div className="w-2 h-2 bg-blue-600 rounded-full mt-1"></div>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* 選択結果表示 */}
                            {selectedScore !== null && (
                                <div className="mt-8 p-4 bg-blue-50 text-blue-800 rounded-lg text-center animate-in fade-in slide-in-from-bottom-2">
                                    <span className="text-sm font-bold block mb-1">選択されたスコア</span>
                                    <span className="text-4xl font-extrabold">{selectedScore}</span>
                                </div>
                            )}

                        </div>

                        {/* 説明エリア */}
                        <div className="flex flex-col items-center">
                            <button 
                                onClick={() => setShowDescription(!showDescription)}
                                className="flex items-center gap-2 text-slate-500 hover:text-slate-700 font-bold bg-white px-6 py-3 rounded-full shadow-sm border border-slate-200 hover:shadow transition-all"
                            >
                                <Info className="w-5 h-5" />
                                <span>{showDescription ? '説明を閉じる' : 'このスケールの使い方'}</span>
                            </button>

                            {showDescription && (
                                <div className="mt-4 p-5 bg-white border border-gray-200 rounded-xl shadow-sm text-sm text-slate-600 leading-relaxed w-full animate-in fade-in zoom-in-95">
                                    <h3 className="font-bold text-slate-800 mb-2">
                                        {mode === 'nrs' ? 'Numerical Rating Scale (NRS)' : 'Faces Pain Scale (FPS)'}
                                    </h3>
                                    <p>{descriptions[mode]}</p>
                                    <div className="mt-3 pt-3 border-t border-gray-100 text-xs text-gray-400">
                                        参考文献: がん疼痛の薬物療法に関するガイドライン(2020年版)
                                    </div>
                                </div>
                            )}
                        </div>

                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<PainScale />);
    </script>
</body>
</html>