<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ccr計算 (Cockcroft-Gault)</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body { font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif; }
        /* モバイルでのタップハイライトを調整 */
        button { -webkit-tap-highlight-color: transparent; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- アイコンコンポーネント ---
        
        const Calculator = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>
        );
        const User = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        );
        const Scale = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="M7 21h10"/><path d="M12 3v18"/><path d="M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2"/></svg>
        );
        const TestTube = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2"/><path d="M8.5 2h7"/><path d="M14.5 16h-5"/></svg>
        );

        function CcrCalculator() {
            const [gender, setGender] = useState('male'); // 'male' or 'female'
            const [age, setAge] = useState('');
            const [weight, setWeight] = useState('');
            const [creatinine, setCreatinine] = useState('');
            const [ccr, setCcr] = useState(null);

            // 計算ロジック
            useEffect(() => {
                if (age && weight && creatinine && !isNaN(age) && !isNaN(weight) && !isNaN(creatinine) && parseFloat(creatinine) > 0) {
                    // Cockcroft-Gault式
                    // Ccr = ((140 - Age) * Weight) / (72 * SCr)  (* 0.85 if female)
                    const ageNum = parseFloat(age);
                    const weightNum = parseFloat(weight);
                    const crNum = parseFloat(creatinine);

                    let result = ((140 - ageNum) * weightNum) / (72 * crNum);
                    
                    if (gender === 'female') {
                        result *= 0.85;
                    }

                    setCcr(result);
                } else {
                    setCcr(null);
                }
            }, [gender, age, weight, creatinine]);

            return (
                <div className="min-h-screen bg-gray-50 flex flex-col items-center font-sans text-gray-800 pb-12">
                    
                    {/* ヘッダー */}
                    <header className="w-full bg-slate-800 text-white py-4 px-6 shadow-md flex justify-center sticky top-0 z-20">
                        <div className="max-w-4xl w-full flex items-center gap-3">
                            <div className="bg-white/10 p-2 rounded-lg">
                                <Calculator className="w-6 h-6 text-indigo-300" />
                            </div>
                            {/* タイトルに「式」を追加済み */}
                            <h1 className="text-xl font-bold tracking-wide">Ccr計算 <span className="text-xs font-normal opacity-70 block sm:inline sm:ml-2">Cockcroft-Gault式</span></h1>
                        </div>
                    </header>

                    <main className="w-full max-w-lg px-4 py-8 space-y-6">

                        {/* 入力フォーム */}
                        <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200 space-y-6">
                            
                            {/* 性別選択 */}
                            <div className="flex bg-gray-100 p-1 rounded-lg relative">
                                <button
                                    onClick={() => setGender('male')}
                                    className={`flex-1 py-3 rounded-md font-bold transition-all flex items-center justify-center gap-2 relative z-10 ${gender === 'male' ? 'bg-white text-blue-600 shadow-sm ring-1 ring-black/5' : 'text-gray-400 hover:text-gray-600'}`}
                                >
                                    <span className="text-lg">男性</span>
                                </button>
                                <button
                                    onClick={() => setGender('female')}
                                    className={`flex-1 py-3 rounded-md font-bold transition-all flex items-center justify-center gap-2 relative z-10 ${gender === 'female' ? 'bg-white text-rose-500 shadow-sm ring-1 ring-black/5' : 'text-gray-400 hover:text-gray-600'}`}
                                >
                                    <span className="text-lg">女性</span>
                                </button>
                            </div>

                            <div className="grid grid-cols-2 gap-6">
                                {/* 年齢 */}
                                <div className="space-y-2">
                                    <label className="block text-sm font-bold text-gray-500 flex items-center gap-1">
                                        <User className="w-4 h-4" /> 年齢
                                    </label>
                                    <div className="relative group">
                                        <input
                                            type="number"
                                            inputMode="decimal"
                                            value={age}
                                            onChange={(e) => setAge(e.target.value)}
                                            className="w-full p-4 pr-12 rounded-lg border-2 border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10 outline-none text-2xl font-bold text-gray-800 text-right transition-all placeholder-gray-300"
                                            placeholder="0"
                                        />
                                        <span className="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 font-bold pointer-events-none group-focus-within:text-indigo-500 transition-colors">歳</span>
                                    </div>
                                </div>

                                {/* 体重 */}
                                <div className="space-y-2">
                                    <label className="block text-sm font-bold text-gray-500 flex items-center gap-1">
                                        <Scale className="w-4 h-4" /> 体重
                                    </label>
                                    <div className="relative group">
                                        <input
                                            type="number"
                                            inputMode="decimal"
                                            value={weight}
                                            onChange={(e) => setWeight(e.target.value)}
                                            className="w-full p-4 pr-12 rounded-lg border-2 border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10 outline-none text-2xl font-bold text-gray-800 text-right transition-all placeholder-gray-300"
                                            placeholder="0"
                                        />
                                        <span className="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 font-bold pointer-events-none group-focus-within:text-indigo-500 transition-colors">kg</span>
                                    </div>
                                </div>
                            </div>

                            {/* 血清クレアチニン */}
                            <div className="space-y-2">
                                <label className="block text-sm font-bold text-gray-500 flex items-center gap-1">
                                    <TestTube className="w-4 h-4" /> 血清クレアチニン (SCr)
                                </label>
                                <div className="relative group">
                                    <input
                                        type="number"
                                        inputMode="decimal"
                                        step="0.01"
                                        value={creatinine}
                                        onChange={(e) => setCreatinine(e.target.value)}
                                        className="w-full p-4 pr-20 rounded-lg border-2 border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10 outline-none text-2xl font-bold text-gray-800 text-right transition-all placeholder-gray-300"
                                        placeholder="0.00"
                                    />
                                    <span className="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 font-bold pointer-events-none group-focus-within:text-indigo-500 transition-colors">mg/dL</span>
                                </div>
                            </div>
                        </div>

                        {/* 結果表示エリア */}
                        <div className={`transition-all duration-500 transform ${ccr !== null ? 'opacity-100 translate-y-0 scale-100' : 'opacity-50 translate-y-4 scale-95 pointer-events-none'}`}>
                            <div className="bg-indigo-600 rounded-xl shadow-lg p-6 text-white text-center relative overflow-hidden ring-4 ring-indigo-50">
                                <div className="absolute top-0 left-0 w-full h-full bg-white opacity-5 pointer-events-none">
                                    <div className="absolute top-[-50%] left-[-50%] w-[200%] h-[200%] rotate-12 bg-gradient-to-b from-transparent via-white to-transparent opacity-20"></div>
                                </div>
                                
                                {/* タイトルをCcrに */}
                                <p className="text-indigo-200 text-sm font-bold mb-1 uppercase tracking-wider">Ccr</p>
                                <div className="flex items-baseline justify-center gap-2">
                                    <span className="text-5xl font-extrabold tracking-tight drop-shadow-sm">
                                        {ccr !== null ? ccr.toFixed(1) : '---'}
                                    </span>
                                    <span className="text-xl font-bold text-indigo-200">mL/min</span>
                                </div>
                                <div className="mt-4 pt-4 border-t border-indigo-500/50 text-xs text-indigo-200 flex flex-col gap-1 text-left bg-indigo-800/20 p-2 rounded-lg">
                                    <p>※ 本計算結果はCockcroft-Gault式に基づく推算値であり、体表面積補正は行われていません。</p>
                                    <p>※ 実際の薬剤投与設計においては、患者の臨床状態を考慮してご判断ください。</p>
                                </div>
                            </div>
                        </div>

                        {/* 計算式の明記 (標準フォントで分数スタイル) */}
                        <div className="mt-8 border-t border-gray-200 pt-6">
                            <h3 className="text-sm font-bold text-gray-500 mb-4 flex items-center gap-2">
                                <Calculator className="w-4 h-4" /> 計算式 (Cockcroft-Gault)
                            </h3>
                            
                            <div className="bg-gray-50 p-4 sm:p-6 rounded-xl border border-gray-200 space-y-8">
                                {/* 男性 */}
                                <div className="flex flex-col gap-2 overflow-x-auto pb-2">
                                    <span className="text-xs font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded border border-blue-100 w-fit">男性</span>
                                    <div className="flex items-center text-gray-800 text-base sm:text-lg whitespace-nowrap pl-1">
                                        <span className="mr-3">Ccr (mL/min) =</span>
                                        <div className="flex flex-col items-center text-center">
                                            <div className="border-b border-gray-800 px-2 pb-1 mb-1 w-full">
                                                (140 − 年齢) × 体重(kg)
                                            </div>
                                            <div className="px-2 pt-1 w-full">
                                                72 × 血清クレアチニン値(mg/dL)
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* 女性 */}
                                <div className="flex flex-col gap-2 border-t border-gray-200 pt-6 overflow-x-auto pb-2">
                                    <span className="text-xs font-bold text-rose-500 bg-rose-50 px-2 py-1 rounded border border-rose-100 w-fit">女性</span>
                                    <div className="flex items-center text-gray-800 text-base sm:text-lg whitespace-nowrap pl-1">
                                        <span className="mr-3">Ccr (mL/min) =</span>
                                        <div className="flex flex-col items-center text-center">
                                            <div className="border-b border-gray-800 px-2 pb-1 mb-1 w-full">
                                                (140 − 年齢) × 体重(kg)
                                            </div>
                                            <div className="px-2 pt-1 w-full">
                                                72 × 血清クレアチニン値(mg/dL)
                                            </div>
                                        </div>
                                        <span className="ml-3">× 0.85</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CcrCalculator />);
    </script>
</body>
</html>